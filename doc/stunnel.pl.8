.\" Automatically generated by Pod::Man 2.1801 (Pod::Simple 3.05)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "STUNNEL.PL 8"
.TH STUNNEL.PL 8 "2009.04.16" "4.08" "stunnel"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAZWA"
.IX Header "NAZWA"
stunnel \- uniwersalny tunel protokoXu \s-1SSL\s0
.SH "SKXADNIA"
.IX Header "SKXADNIA"
.IP "\fBUnix:\fR" 4
.IX Item "Unix:"
\&\fBstunnel\fR [<plik>] | \-fd\ n | \-help | \-version | \-sockets
.IP "\fB\s-1WIN32:\s0\fR" 4
.IX Item "WIN32:"
\&\fBstunnel\fR [ [\-install | \-uninstall | \-start | \-stop ]
    [\-quiet] [<plik>] ] | \-help | \-version | \-sockets
.SH "OPIS"
.IX Header "OPIS"
Program \fBstunnel\fR zostaX zaprojektowany do opakowywania w protoko\*'X \fI\s-1SSL\s0\fR
poXXczen\*~ pomie\*^dzy zdalnymi klientami a lokalnymi lub zdalnymi serwerami.
Przez serwer lokalny rozumiana jest aplikacja przeznaczona do uruchamiania
przy pomocy \fIinetd\fR.
Stunnel pozwala na proste zestawienie komunikacji serwero\*'w nie posiadajXcych
funkcjonalnoXci \fI\s-1SSL\s0\fR poprzez bezpieczne kanaXy \fI\s-1SSL\s0\fR.
.PP
\&\fBstunnel\fR pozwala doda\*(ae funkcjonalnoX\*(ae \fI\s-1SSL\s0\fR do powszechnie stosowanych
demono\*'w \fIinetd\fR, np. \fIpop3\fR lub \fIimap\fR, do samodzielnych demono\*'w,
np. \fInntp\fR, \fIsmtp\fR lub \fIhttp\fR, a nawet tunelowa\*(ae ppp poprzez gniazda sieciowe
bez zmian w kodzie Xro\*'dXowym.
.SH "OPCJE"
.IX Header "OPCJE"
.IP "<\fBplik\fR>" 4
.IX Item "<plik>"
uXyj podanego pliku konfiguracyjnego
.IP "\fB\-fd n\fR (tylko Unix)" 4
.IX Item "-fd n (tylko Unix)"
wczytaj konfiguracje\*^ z podanego deskryptora pliku
.IP "\fB\-help\fR" 4
.IX Item "-help"
drukuj liste\*^ wspieranych opcji
.IP "\fB\-version\fR" 4
.IX Item "-version"
drukuj wersje\*^ programu i domyXlne wartoXci parametro\*'w
.IP "\fB\-sockets\fR" 4
.IX Item "-sockets"
drukuj domyXlne opcje gniazd
.IP "\fB\-install\fR (tylko \s-1NT/2000/XP\s0)" 4
.IX Item "-install (tylko NT/2000/XP)"
instaluj serwis \s-1NT\s0
.IP "\fB\-uninstall\fR (tylko \s-1NT/2000/XP\s0)" 4
.IX Item "-uninstall (tylko NT/2000/XP)"
odinstaluj serwis \s-1NT\s0
.IP "\fB\-start\fR (tylko \s-1NT/2000/XP\s0)" 4
.IX Item "-start (tylko NT/2000/XP)"
uruchom serwis \s-1NT\s0
.IP "\fB\-stop\fR (tylko \s-1NT/2000/XP\s0)" 4
.IX Item "-stop (tylko NT/2000/XP)"
zatrzymaj serwis \s-1NT\s0
.IP "\fB\-quiet\fR (tylko \s-1NT/2000/XP\s0)" 4
.IX Item "-quiet (tylko NT/2000/XP)"
nie wyXwietlaj okienka informujXcego o pomyXlnym zainstalowaniu lub
odinstalowaniu
.SH "PLIK KONFIGURACYJNY"
.IX Header "PLIK KONFIGURACYJNY"
Linia w pliku konfiguracyjnym moXe by\*(ae:
.IP "\(bu" 4
pusta (ignorowana)
.IP "\(bu" 4
komentarzem rozpoczynajXcym sie\*^ znakiem ';' (ignorowana)
.IP "\(bu" 4
parX 'nazwa_opcji = wartoX\*(ae_opcji'
.IP "\(bu" 4
tekstem '[nazwa_usXugi]' wskazujXcym poczXtek definicji usXugi
.SS "\s-1OPCJE\s0 \s-1GLOBALNE\s0"
.IX Subsection "OPCJE GLOBALNE"
.IP "\fBchroot\fR = katalog (tylko Unix)" 4
.IX Item "chroot = katalog (tylko Unix)"
katalog roboczego korzenia systemu pliko\*'w
.Sp
Opcja okreXla katalog, w kto\*'rym uwie\*^ziony zostanie proces programu
\&\fBstunnel\fR tuX po jego inicjalizacji, a przed rozpocze\*^ciem odbierania
poXXczen\*~.  XcieXki podane w opcjach \fICApath\fR, \fICRLpath\fR, \fIpid\fR
oraz \fIexec\fR muszX by\*(ae umieszczone wewnXtrz katalogu podanego w opcji
\&\fIchroot\fR i okreXlone wzgle\*^dem tego katalogu.
.Sp
W przypadku wykorzystania kontroli doste\*^pu przy pomocy biblioteki
libwrap (\s-1TCP\s0 wrappers) jej pliki konfiguracyjne (/etc/hosts.allow i
/etc/hosts.deny) muszX zosta\*(ae skopiowane do podkatalogu etc/
umieszczonego wewnXtrz katalogu podanego w opcji \fIchroot\fR.
.IP "\fBcompression\fR = zlib | rle" 4
.IX Item "compression = zlib | rle"
wybo\*'r algorytmu kompresji przesyXanych danych
.Sp
domyXlnie: bez kompresji
.IP "\fBdebug\fR = poziom[.podsystem]" 4
.IX Item "debug = poziom[.podsystem]"
szczego\*'XowoX\*(ae logowania
.Sp
Poziom logowania moXna okreXli\*(ae przy pomocy jednej z nazw lub liczb:
emerg (0), alert (1), crit (2), err (3), warning (4), notice (5),
info (6) lub debug (7).
Zapisywane sX komunikaty o poziomie niXszym (numerycznie) lub ro\*'wnym podanemu.
Do uzyskania najwyXszego poziomu szczego\*'XowoXci moXna uXy\*(ae opcji
\&\fBdebug = debug\fR lub \fBdebug = 7\fR.  DomyXlnym poziomem jest notice (5).
.Sp
O ile nie wyspecyfikowano podsystemu uXyty be\*^dzie domyXlny: daemon.
Podsystemy nie sX wspierane przez platforme\*^ Win32.
.Sp
WielkoX\*(ae liter jest ignorowana zaro\*'wno dla poziomu jak podsystemu.
.IP "\fB\s-1EGD\s0\fR = XcieXka_do_EGD (tylko Unix)" 4
.IX Item "EGD = XcieXka_do_EGD (tylko Unix)"
XcieXka do gniazda programu Entropy Gathering Daemon
.Sp
Opcja pozwala okreXli\*(ae XcieXke\*^ do gniazda programu Entropy Gathering Daemon
uXywanego do zainicjalizowania generatora ciXgo\*'w pseudolosowych biblioteki
OpenSSL.  Opcja jest doste\*^pna z bibliotekX OpenSSL 0.9.5a lub nowszX.
.IP "\fBengine\fR = auto | <identyfikator urzXdzenia>" 4
.IX Item "engine = auto | <identyfikator urzXdzenia>"
wybo\*'r sprze\*^towego urzXdzenia kryptograficznego
.Sp
domyXlnie: bez wykorzystania urzXdzen\*~ kryptograficznych
.Sp
PrzykXad wykorzystania w sekcji '\s-1PRZYKXADY\s0'.
.IP "\fBengineCtrl\fR = <command>[:<parameter>]" 4
.IX Item "engineCtrl = <command>[:<parameter>]"
konfiguracja urzXdzenia kryptograficznego
.Sp
Specjalne komendy \*(L"\s-1LOAD\s0\*(R" i \*(L"\s-1INIT\s0\*(R" pozwalajX na zaXadowanie i inicjalizacje\*^
moduXu kryptograficznego urzXdzenia.
.IP "\fBforeground\fR = yes | no (tylko Unix)" 4
.IX Item "foreground = yes | no (tylko Unix)"
tryb pierwszoplanowy
.Sp
UXycie tej opcji powoduje, Xe \fIstunnel\fR nie przechodzi w tXo logujXc
swoje komunikaty na konsole\*^ zamiast przez \fIsyslog\fR (o ile nie uXyto
opcji \fIoutput\fR).
.IP "\fBoutput\fR = plik" 4
.IX Item "output = plik"
plik, do kto\*'rego dopisane zostanX logi
.Sp
UXycie tej opcji zmienia domyXlne zachowanie programu polegajXce
na logowaniu swoich komunikato\*'w poprzez syslog.
.Sp
Do przekierowania komunikato\*'w na standardowe wyjXcie (na przykXad po to,
Xeby zalogowa\*(ae je programem splogger z pakietu daemontools) moXna poda\*(ae
jako parametr urzXdzenie /dev/stdout.
.IP "\fBpid\fR = plik (tylko Unix)" 4
.IX Item "pid = plik (tylko Unix)"
poXoXenie pliku z numerem procesu
.Sp
JeXeli argument jest pusty plik nie zostanie stworzony.
.Sp
JeXeli zdefiniowano katalog \fIchroot\fR, to XcieXka do \fIpid\fR jest okreXlona
wzgle\*^dem tego katalogu.
.IP "\fBRNDbytes\fR = liczba_bajto\*'w" 4
.IX Item "RNDbytes = liczba_bajto'w"
liczba bajto\*'w do zainicjowania generatora pseudolosowego
.Sp
W wersjach biblioteki OpenSSL starszych niX 0.9.5a opcja ta okreXla
ro\*'wnieX liczbe\*^ bajto\*'w wystarczajXcych do zainicjowania \s-1PRNG\s0.
Nowsze wersje biblioteki majX wbudowanX funkcje\*^ okreXlajXcX, czy
dostarczona iloX\*(ae losowoXci jest wystarczajXca do zainicjowania generatora.
.IP "\fBRNDfile\fR = plik" 4
.IX Item "RNDfile = plik"
XcieXka do pliku zawierajXcego losowe dane
.Sp
Biblioteka OpenSSL uXyje danych z tego pliku do zainicjowania
generatora pseudolosowego.
.IP "\fBRNDoverwrite\fR = yes | no" 4
.IX Item "RNDoverwrite = yes | no"
nadpisz plik nowymi wartoXciami pseudolosowymi
.Sp
domyXlnie: yes (nadpisz)
.IP "\fBservice\fR = nazwa_serwisu" 4
.IX Item "service = nazwa_serwisu"
uXyj parametru jako nazwy serwisu
.Sp
\&\fBUnix:\fR nazwa serwisu dla biblioteki \s-1TCP\s0 Wrapper w trybie \fIinetd\fR.
.Sp
\&\fB\s-1NT/2000/XP:\s0\fR nazwa serwisu \s-1NT\s0 w Panelu Sterowania.
.Sp
domyXlnie: stunnel
.IP "\fBsetgid\fR = identyfikator_grupy (tylko Unix)" 4
.IX Item "setgid = identyfikator_grupy (tylko Unix)"
grupa z kto\*'rej prawami pracowaX be\*^dzie \fIstunnel\fR
.IP "\fBsetuid\fR = identyfikator_uXytkownika (tylko Unix)" 4
.IX Item "setuid = identyfikator_uXytkownika (tylko Unix)"
uXytkownik, z kto\*'rego prawami pracowaX be\*^dzie \fIstunnel\fR
.IP "\fBsocket\fR = a|l|r:option=value[:value]" 4
.IX Item "socket = a|l|r:option=value[:value]"
ustaw opcje\*^ na akceptujXcym/lokalnym/zdalnym gnieXdzie
.Sp
Dla opcji linger wartoXci majX posta\*(ae l_onof:l_linger.
Dla opcji time wartoXci majX posta\*(ae tv_sec:tv_usec.
.Sp
PrzykXady:
.Sp
.Vb 10
\&    socket = l:SO_LINGER=1:60
\&        ustaw jednominutowe przeterminowanie
\&        przy zamykaniu lokalnego gniazda
\&    socket = r:TCP_NODELAY=1
\&        wyXXcz algorytm Nagle\*(Aqa na zdalnych
\&        gniazdach
\&    socket = r:SO_OOBINLINE=1
\&        umieX\*(ae dane pozapasmowe (out\-of\-band)
\&        bezpoXrednio w strumieniu danych
\&        wejXciowych dla zdalnych gniazd
\&    socket = a:SO_REUSEADDR=0
\&        zablokuj ponowne uXywanie portu
\&        (domyXlnie wXXczone)
\&    socket = a:SO_BINDTODEVICE=lo
\&        przyjmuj poXXczenia wyXXcznie na
\&        interfejsie zwrotnym (ang. loopback)
.Ve
.IP "\fBsyslog\fR = yes | no (tylko Unix)" 4
.IX Item "syslog = yes | no (tylko Unix)"
wXXcz logowanie poprzez mechanizm syslog
.Sp
domyXlnie: yes (wXXcz)
.IP "\fBtaskbar\fR = yes | no (tylko \s-1WIN32\s0)" 4
.IX Item "taskbar = yes | no (tylko WIN32)"
wXXcz ikonke\*^ w prawym dolnym rogu ekranu
.Sp
domyXlnie: yes (wXXcz)
.SS "\s-1OPCJE\s0 \s-1USXUG\s0"
.IX Subsection "OPCJE USXUG"
KaXda sekcja konfiguracji usXugi zaczyna sie\*^ jej nazwX uje\*^tX w nawias
kwadratowy.  Nazwa usXugi uXywana jest do kontroli doste\*^pu przez
biblioteke\*^ libwrap (\s-1TCP\s0 wrappers) oraz pozwala rozro\*'Xni\*(ae poszczego\*'lne
usXugi w logach.
.PP
JeXeli \fBstunnel\fR ma zosta\*(ae uXyty w trybie \fIinetd\fR, gdzie za odebranie
poXXczenia odpowiada osobny program (zwykle \fIinetd\fR, \fIxinetd\fR
lub \fItcpserver\fR), naleXy przeczyta\*(ae sekcje\*^ \fB\s-1TRYB\s0 \s-1INETD\s0\fR poniXej.
.IP "\fBaccept\fR = [adres:]port" 4
.IX Item "accept = [adres:]port"
nasXuchuje na poXXczenia na podanym adresie i porcie
.Sp
JeXeli nie zostaX podany adres, \fIstunnel\fR domyXlnie nasXuchuje
na wszystkich adresach \s-1IP\s0 lokalnych interfejso\*'w.
.IP "\fBCApath\fR = katalog_CA" 4
.IX Item "CApath = katalog_CA"
katalog Centrum Certyfikacji
.Sp
Opcja okreXla katalog, w kto\*'rym \fBstunnel\fR be\*^dzie szukaX certyfikato\*'w,
jeXeli uXyta zostaXa opcja \fIverify\fR.  Pliki z certyfikatami muszX
posiada\*(ae specjalne nazwy \s-1XXXXXXXX\s0.0, gdzie \s-1XXXXXXXX\s0 jest skro\*'tem
kryptograficznym reprezentacji \s-1DER\s0 nazwy podmiotu certyfikatu
(4 pierwsze bajty skro\*'tu \s-1MD5\s0 poczXwszy od najmniej znaczacego).
.Sp
JeXeli zdefiniowano katalog \fIchroot\fR, to XcieXka do \fICApath\fR jest okreXlona
wzgle\*^dem tego katalogu.
.IP "\fBCAfile\fR = plik_CA" 4
.IX Item "CAfile = plik_CA"
plik Centrum Certyfikacji
.Sp
Opcja pozwala okreXli\*(ae poXoXenie pliku zawierajXcego certyfikaty uXywane
przez opcje\*^ \fIverify\fR.
.IP "\fBcert\fR = plik_pem" 4
.IX Item "cert = plik_pem"
plik z Xan\*~cuchem certyfikato\*'w
.Sp
Opcja okreXla poXoXenie pliku zawierajXcego certyfikaty uXywane przez
program \fBstunnel\fR do uwierzytelnienia sie\*^ przed drugX stronX poXXczenia.
Certyfikat jest konieczny, aby uXywa\*(ae programu w trybie serwera.
W trybie klienta certyfikat jest opcjonalny.
.IP "\fBciphers\fR = lista_szyfro\*'w" 4
.IX Item "ciphers = lista_szyfro'w"
lista dozwolonych szyfro\*'w \s-1SSL\s0
.Sp
Parametrem tej opcji jest lista szyfro\*'w, kto\*'re be\*^dX uXyte przy
otwieraniu nowych poXXczen\*~ \s-1SSL\s0, np.:  \s-1DES\-CBC3\-SHA:IDEA\-CBC\-MD5\s0
.IP "\fBclient\fR = yes | no" 4
.IX Item "client = yes | no"
tryb kliencki (zdalna usXuga uXywa \s-1SSL\s0)
.Sp
domyXlnie: no (tryb serwerowy)
.IP "\fBconnect\fR = [adres:]port" 4
.IX Item "connect = [adres:]port"
poXXcz sie\*^ ze zdalnym serwerem na podany port
.Sp
JeXeli nie zostaX podany adres, \fIstunnel\fR domyXlnie XXczy sie\*^
z lokalnym serwerem.
.Sp
Komenda moXe byc uXyta wielokrotnie w pojedynczej sekcji
celem zapewnienia wysokiej niezawodnoXci lub rozXoXenia
ruchu pomie\*^dzy wiele serwero\*'w.
.IP "\fBCRLpath\fR = katalog_CRL" 4
.IX Item "CRLpath = katalog_CRL"
katalog List OdwoXanych Certyfikato\*'w (\s-1CRL\s0)
.Sp
Opcja okreXla katalog, w kto\*'rym \fBstunnel\fR be\*^dzie szukaX list \s-1CRL\s0,
jeXeli uXyta zostaXa opcja \fIverify\fR.  Pliki z listami \s-1CRL\s0 muszX
posiada\*(ae specjalne nazwy \s-1XXXXXXXX\s0.0, gdzie \s-1XXXXXXXX\s0 jest skro\*'tem
listy \s-1CRL\s0.
.Sp
JeXeli zdefiniowano katalog \fIchroot\fR, to XcieXka do \fICRLpath\fR jest okreXlona
wzgle\*^dem tego katalogu.
.IP "\fBCRLfile\fR = plik_CRL" 4
.IX Item "CRLfile = plik_CRL"
plik List OdwoXanych Certyfikato\*'w (\s-1CRL\s0)
.Sp
Opcja pozwala okreXli\*(ae poXoXenie pliku zawierajXcego listy \s-1CRL\s0 uXywane
przez opcje\*^ \fIverify\fR.
.IP "\fBdelay\fR = yes | no" 4
.IX Item "delay = yes | no"
opo\*'Xnij rozwinie\*^cie adresu \s-1DNS\s0 podanego w opcji \fIconnect\fR
.IP "\fBengineNum\fR = <numer urzXdzenia>" 4
.IX Item "engineNum = <numer urzXdzenia>"
wybierz urzXdzenie do odczyta klucza prywatnego
.Sp
UrzXdzenia sX numerowane od 1 w go\*'re\*^.
.IP "\fBexec\fR = XcieXka_do_programu (tylko Unix)" 4
.IX Item "exec = XcieXka_do_programu (tylko Unix)"
wykonaj lokalny program przystosowany do pracy z superdemonem inetd
.Sp
JeXeli zdefiniowano katalog \fIchroot\fR, to XcieXka do \fIexec\fR jest okreXlona
wzgle\*^dem tego katalogu.
.ie n .IP "\fBexecargs\fR = $0 $1 $2 ... (tylko Unix)" 4
.el .IP "\fBexecargs\fR = \f(CW$0\fR \f(CW$1\fR \f(CW$2\fR ... (tylko Unix)" 4
.IX Item "execargs = $0 $1 $2 ... (tylko Unix)"
argumenty do opcji \fIexec\fR wXXcznie z nazwX programu ($0)
.Sp
Cytowanie nie jest wspierane w obecnej wersji programu.
Argumenty sX rozdzielone dowolnX liczbX biaXych znako\*'w.
.IP "\fBfailover\fR = rr | prio" 4
.IX Item "failover = rr | prio"
Strategia wybierania serwero\*'w wyspecyfikowanych parametrami \*(L"connect\*(R".
.Sp
.Vb 2
\&    rr (round robin) \- sprawiedliwe rozXoXenie obciXXenia
\&    prio (priority) \- uXyj kolejnoXci opcji w pliku konfiguracyjnym
.Ve
.Sp
domyXlnie: rr
.IP "\fBident\fR = nazwa_uXytkownika" 4
.IX Item "ident = nazwa_uXytkownika"
weryfikuj nazwe\*^ zdalnego uXytkownika korzystajXc z protokoXu \s-1IDENT\s0 (\s-1RFC\s0 1413)
.IP "\fBkey\fR = plik_klucza" 4
.IX Item "key = plik_klucza"
klucz prywatny do certyfikatu podanego w opcji \fIcert\fR
.Sp
Klucz prywatny jest potrzebny do uwierzytelnienia wXaXciciela certyfikatu.
PoniewaX powinien on by\*(ae zachowany w tajemnicy, prawa do jego odczytu
powinien mie\*(ae wyXXcznie wXaXciciel pliku.  W systemie Unix moXna to osiXgnX\*(ae
komendX:
.Sp
.Vb 1
\&    chmod 600 keyfile
.Ve
.Sp
domyXlnie: wartoX\*(ae opcji \fIcert\fR
.IP "\fBlocal\fR = serwer" 4
.IX Item "local = serwer"
\&\s-1IP\s0 Xro\*'dXa do nawiXzywania zdalnych poXXczen\*~
.Sp
DomyXlnie uXywane jest \s-1IP\s0 najbardziej zewne\*^trznego interfejsu w strone\*^
serwera, do kto\*'rego nawiXzywane jest poXXczenie.
.IP "\fB\s-1OCSP\s0\fR = \s-1URL\s0" 4
.IX Item "OCSP = URL"
serwer \s-1OCSP\s0 do weryfikacji certyfikato\*'w
.IP "\fBOCSPflag\fR = flaga" 4
.IX Item "OCSPflag = flaga"
flaga serwera \s-1OCSP\s0
.Sp
aktualnie wspierane flagi: \s-1NOCERTS\s0, \s-1NOINTERN\s0 \s-1NOSIGS\s0, \s-1NOCHAIN\s0, \s-1NOVERIFY\s0,
\&\s-1NOEXPLICIT\s0, \s-1NOCASIGN\s0, \s-1NODELEGATED\s0, \s-1NOCHECKS\s0, \s-1TRUSTOTHER\s0, \s-1RESPID_KEY\s0, \s-1NOTIME\s0
.Sp
Aby wyspecyfikowa\*(ae kilka flag naleXy uXy\*(ae \fIOCSPflag\fR wielokrotnie.
.IP "\fBoptions\fR = opcje_SSL" 4
.IX Item "options = opcje_SSL"
opcje biblioteki OpenSSL
.Sp
Parametrem jest nazwa opcji zgodnie z opisem w \fI\fISSL_CTX_set_options\fI\|(3ssl)\fR,
ale bez przedrostka \fI\s-1SSL_OP_\s0\fR.
Aby wyspecyfikowa\*(ae kilka opcji naleXy uXy\*(ae \fIoptions\fR wielokrotnie.
.Sp
Na przykXad dla zachowania kompatybilnoXci z bXe\*^dami implementacji \s-1SSL\s0
w programie Eudora moXna uXy\*(ae opcji:
.Sp
.Vb 1
\&    options = DONT_INSERT_EMPTY_FRAGMENTS
.Ve
.IP "\fBprotocol\fR = protoko\*'X" 4
.IX Item "protocol = protoko'X"
negocjuj \s-1SSL\s0 podanym protokoXem aplikacyjnym
.Sp
aktualnie wspierane protokoXy: cifs, connect, imap, nntp, pop3, smtp, pgsql
.IP "\fBprotocolAuthentication\fR = uwierzytelnienie" 4
.IX Item "protocolAuthentication = uwierzytelnienie"
rodzaj uwierzytelnienia do negocjacji protokoXu
.Sp
aktualnie wspierane: basic, \s-1NTLM\s0
.Sp
Obecnie typ uwierzytelnienia ma zastosowanie wyXXcznie w protokole 'connect'.
.Sp
domyXlnie: basic
.IP "\fBprotocolHost\fR = adres:port" 4
.IX Item "protocolHost = adres:port"
adres docelowy do negocjacji protokoXu
.IP "\fBprotocolPassword\fR = hasXo" 4
.IX Item "protocolPassword = hasXo"
hasXo do negocjacji protokoXu
.IP "\fBprotocolUsername\fR = uXytkownik" 4
.IX Item "protocolUsername = uXytkownik"
nazwa uXytkownika do negocjacji protokoXu
.IP "\fBpty\fR = yes | no (tylko Unix)" 4
.IX Item "pty = yes | no (tylko Unix)"
alokuj pseudoterminal dla programu uruchamianego w opcji 'exec'
.IP "\fBretry\fR = yes | no (tylko Unix)" 4
.IX Item "retry = yes | no (tylko Unix)"
poXXcz ponownie sekcje\*^ connect+exec po rozXXczeniu
.Sp
domyXlnie: no
.IP "\fBsession\fR = przeterminowanie_pamie\*^ci_podre\*^cznej_sesji" 4
.IX Item "session = przeterminowanie_pamie^ci_podre^cznej_sesji"
czas w sekundach, po kto\*'rym sesja \s-1SSL\s0 zostanie usunie\*^ta z pamie\*^ci podre\*^cznej
.IP "\fBsslVersion\fR = wersja" 4
.IX Item "sslVersion = wersja"
wersja protokoXu \s-1SSL\s0
.Sp
Dozwolone opcje: all, SSLv2, SSLv3, TLSv1
.IP "\fBstack\fR = liczba_bajto\*'w (z wyjXtkiem modelu \s-1FORK\s0)" 4
.IX Item "stack = liczba_bajto'w (z wyjXtkiem modelu FORK)"
rozmiar stosu procesora wXtku
.IP "\fBTIMEOUTbusy\fR = liczba_sekund" 4
.IX Item "TIMEOUTbusy = liczba_sekund"
czas oczekiwania na spodziewane dane
.IP "\fBTIMEOUTclose\fR = liczba_sekund" 4
.IX Item "TIMEOUTclose = liczba_sekund"
czas oczekiwania na close_notify (ustaw na 0, jeXeli klientem jest \s-1MSIE\s0)
.IP "\fBTIMEOUTconnect\fR = liczba_sekund" 4
.IX Item "TIMEOUTconnect = liczba_sekund"
czas oczekiwania na nawiXzanie poXXczenia
.IP "\fBTIMEOUTidle\fR = liczba_sekund" 4
.IX Item "TIMEOUTidle = liczba_sekund"
maksymalny czas utrzymywania bezczynnego poXXczenia
.IP "\fBtransparent\fR = yes | no (tylko Unix)" 4
.IX Item "transparent = yes | no (tylko Unix)"
tryb przezroczystego proxy
.Sp
Przepisz adres, aby nawiXzywane poXXczenie wydawaXo sie\*^ pochodzi\*(ae
bezpoXrednio od klienta, a nie od programu \fIstunnel\fR.
Opcja dziaXa tylko w trybie lokalnym (opcja \fIexec\fR) przez zaXadowanie
przy pomocy \s-1LD_PRELOAD\s0 biblioteki env.so, albo w trybie zdalnym (opcja
\&\fIconnect\fR) na systemie Linux 2.2 z wXXczonX opcjX \fItransparent proxy\fR.
.IP "\fBverify\fR = poziom" 4
.IX Item "verify = poziom"
weryfikuj certyfikat drugiej strony poXXczenia
.Sp
.Vb 7
\&    poziom 1 \- weryfikuj, jeXeli zostaX
\&        przedstawiony
\&    poziom 2 \- weryfikuj z zainstalowanym
\&        certyfikatem Centrum Certyfikacji
\&    poziom 3 \- weryfikuj z lokalnie
\&        zainstalowanym certyfikatem drugiej strony
\&    domyXlnie \- nie weryfikuj
.Ve
.SH "ZWRACANA WARTOX\*(AE"
.IX Header "ZWRACANA WARTOX"
\&\fBstunnel\fR zwraca zero w przypadku sukcesu, lub wartoX\*(ae niezerowX
w przypadku bXe\*^du.
.SH "PRZYKXADY"
.IX Header "PRZYKXADY"
Szyfrowanie poXXczen\*~ do lokalnego serwera \fIimapd\fR moXna uXy\*(ae:
.PP
.Vb 4
\&    [imapd]
\&    accept = 993
\&    exec = /usr/sbin/imapd
\&    execargs = imapd
.Ve
.PP
albo w trybie zdalnym:
.PP
.Vb 3
\&    [imapd]
\&    accept = 993
\&    connect = 143
.Ve
.PP
W poXXczeniu z programem \fIpppd\fR \fBstunnel\fR pozwala zestawi\*(ae prosty \s-1VPN\s0.
Po stronie serwera nasXuchujXcego na porcie 2020 jego konfiguracja
moXe wyglXda\*(ae naste\*^pujXco:
.PP
.Vb 5
\&    [vpn]
\&    accept = 2020
\&    exec = /usr/sbin/pppd
\&    execargs = pppd local
\&    pty = yes
.Ve
.PP
PoniXszy plik konfiguracyjny moXe by\*(ae wykorzystany do uruchomienia
programu \fBstunnel\fR w trybie \fIinetd\fR.  Warto zauwaXy\*(ae, Xe w pliku
konfiguracyjnym nie ma sekcji \fI[nazwa_usXugi]\fR.
.PP
.Vb 2
\&    exec = /usr/sbin/imapd
\&    execargs = imapd
.Ve
.PP
PrzykXadowa konfiguracja umoXliwiajXca odczytanie klucza prywatnego z
urzXdzenia zgodnego z OpenSC
.PP
.Vb 7
\&    engine=dynamic
\&    engineCtrl=SO_PATH:/usr/lib/opensc/engine_pkcs11.so
\&    engineCtrl=ID:pkcs11
\&    engineCtrl=LIST_ADD:1
\&    engineCtrl=LOAD
\&    engineCtrl=MODULE_PATH:/usr/lib/pkcs11/opensc\-pkcs11.so
\&    engineCtrl=INIT
\&
\&    [service]
\&    engineNum=1
\&    key=id_45
.Ve
.SH "PLIKI"
.IX Header "PLIKI"
.IP "\fIstunnel.conf\fR" 4
.IX Item "stunnel.conf"
plik konfiguracyjny programu
.IP "\fIstunnel.pem\fR" 4
.IX Item "stunnel.pem"
certyfikat i klucz prywatny
.SH "BXE\*^DY"
.IX Header "BXE^DY"
Opcja \fIexecargs\fR nie obsXuguje cytowania.
.SH "OGRANICZENIA"
.IX Header "OGRANICZENIA"
\&\fIstunnel\fR nie moXe by\*(ae uXywany do szyfrowania protokoXu \fI\s-1FTP\s0\fR,
poniewaX do przesyXania poszczego\*'lnych pliko\*'w uXywa on dodatkowych
poXXczen\*~ otwieranych na portach o dynamicznie przydzielanych numerach.
IstniejX jednak specjalne wersje kliento\*'w i serwero\*'w \s-1FTP\s0 pozwalajXce
na szyfrowanie przesyXanych danych przy pomocy protokoXu \fI\s-1SSL\s0\fR.
.SH "NOTKI"
.IX Header "NOTKI"
.SS "\s-1TRYB\s0 \s-1INETD\s0 (tylko Unix)"
.IX Subsection "TRYB INETD (tylko Unix)"
W wie\*^kszoXci zastosowan\*~ \fBstunnel\fR samodzielnie nasXuchuje na porcie
podanym w pliku konfiguracyjnym i tworzy poXXczenie z innym portem
podanym w opcji \fIconnect\fR lub nowym programem podanym w opcji \fIexec\fR.
Niekto\*'rzy wolX jednak wykorzystywa\*(ae oddzielny program, kto\*'ry odbiera
poXXczenia, po czym uruchamia program \fBstunnel\fR.  PrzykXadami takich
programo\*'w sX inetd, xinetd i tcpserver.
.PP
PrzykXadowa linia pliku /etc/inetd.conf moXe wyglXda\*(ae tak:
.PP
.Vb 2
\&    imaps stream tcp nowait root /usr/bin/stunnel
\&        stunnel /etc/stunnel/imaps.conf
.Ve
.PP
PoniewaX w takich przypadkach poXXczenie na zdefiniowanym porcie
(tutaj \fIimaps\fR) nawiXzuje osobny program (tutaj \fIinetd\fR), \fBstunnel\fR
nie moXe uXywa\*(ae opcji \fIaccept\fR.  W pliku konfiguracyjnym nie moXe
by\*(ae ro\*'wnieX zdefiniowana Xadna usXuga (\fI[nazwa_usXugi]\fR), poniewaX
konfiguracja taka pozwala na nawiXzanie tylko jednego poXXczenia.
Wszystkie \fI\s-1OPCJE\s0 \s-1USXUG\s0\fR powinny by\*(ae umieszczone razem z opcjami
globalnymi.  PrzykXad takiej konfiguracji znajduje sie\*^ w sekcji
\&\fI\s-1PRZYKXADY\s0\fR.
.SS "\s-1CERTYFIKATY\s0"
.IX Subsection "CERTYFIKATY"
Protoko\*'X \s-1SSL\s0 wymaga, aby kaXdy serwer przedstawiaX sie\*^ nawiXzujXcemu
poXXczenie klientowi prawidXowym certyfikatem X.509.
Potwierdzenie toXsamoXci serwera polega na wykazaniu, Xe posiada on
odpowiadajXcy certyfikatowi klucz prywatny.
NajprostszX metodX uzyskania certyfikatu jest wygenerowanie
go przy pomocy wolnego pakietu \fIOpenSSL\fR.  Wie\*^cej informacji na temat
generowania certyfikato\*'w moXna znaleX\*(ae na umieszczonych poniXej stronach.
.PP
IstotnX kwestiX jest kolejnoX\*(ae zawartoXci pliku \fI.pem\fR.
W pierwszej kolejnoXci powinien on zawiera\*(ae klucz prywatny,
a dopiero za nim podpisany certyfikat (nie XXdanie certyfikatu).
Po certyfikacie i kluczu prywatnym powinny znajdowa\*(ae sie\*^ puste linie.
JeXeli przed certyfikatem znajdujX sie\*^ dodatkowe informacje tekstowe,
to powinny one zosta\*(ae usunie\*^te.  Otrzymany plik powinien mie\*(ae
naste\*^pujXcX posta\*(ae:
.PP
.Vb 8
\&    \-\-\-\-\-BEGIN RSA PRIVATE KEY\-\-\-\-\-
\&    [zakodowany klucz]
\&    \-\-\-\-\-END RSA PRIVATE KEY\-\-\-\-\-
\&    [pusta linia]
\&    \-\-\-\-\-BEGIN CERTIFICATE\-\-\-\-\-
\&    [zakodowany certyfikat]
\&    \-\-\-\-\-END CERTIFICATE\-\-\-\-\-
\&    [pusta linia]
.Ve
.SS "LOSOWOX\*(\s-1AE\s0"
.IX Subsection "LOSOWOX-1AE"
\&\fBstunnel\fR potrzebuje zainicjowa\*(ae \s-1PRNG\s0 (generator liczb pseudolosowych),
gdyX protoko\*'X \s-1SSL\s0 wymaga do bezpieczen\*~stwa kryptograficznego Xro\*'dXa
dobrej losowoXci.  Naste\*^pujXce Xro\*'dXa sX kolejno odczytywane aX do
uzyskania  wystarczajXcej iloXci entropii:
.IP "\(bu" 4
ZawartoX\*(ae pliku podanego w opcji \fIRNDfile\fR.
.IP "\(bu" 4
ZawartoX\*(ae pliku o nazwie okreXlonej przez zmiennX XrodowiskowX
\&\s-1RANDFILE\s0, o ile jest ona ustawiona.
.IP "\(bu" 4
Plik .rnd umieszczony w katalogu domowym uXytkownika,
jeXeli zmienna \s-1RANDFILE\s0 nie jest ustawiona.
.IP "\(bu" 4
Plik podany w opcji '\-\-with\-random' w czasie konfiguracji programu.
.IP "\(bu" 4
ZawartoX\*(ae ekranu w systemie Windows.
.IP "\(bu" 4
Gniazdo egd, jeXeli uXyta zostaXa opcja \fI\s-1EGD\s0\fR.
.IP "\(bu" 4
Gniazdo egd podane w opcji '\-\-with\-egd\-socket' w czasie konfiguracji programu.
.IP "\(bu" 4
UrzXdzenie /dev/urandom.
.PP
Wspo\*'Xczesne (>=0.9.5a) wersje biblioteki \fIOpenSSL\fR automatycznie
zaprzestajX Xadowania kolejnych danych w momencie uzyskania wystarczajXcej
iloXci entropii.  WczeXniejsze wersje biblioteki wykorzystajX wszystkie
powyXsze Xro\*'dXa, gdyX nie istnieje tam funkcja pozwalajXca okreXli\*(ae,
czy uzyskano juX wystarczajXco duXo danych.
.PP
Warto zwro\*'ci\*(ae uwage\*^, Xe na maszynach z systemem Windows, na kto\*'rych
konsoli nie pracuje uXytkownik, zawartoX\*(ae ekranu nie jest wystarczajXco
zmienna, aby zainicjowa\*(ae \s-1PRNG\s0.  W takim przypadku do zainicjowania
generatora naleXy uXy\*(ae opcji \fIRNDfile\fR.
.PP
Plik \fIRNDfile\fR powinien zawiera\*(ae dane losowe \*(-- ro\*'wnieX w tym sensie,
Xe powinny by\*(ae one inne przy kaXdym uruchomieniu programu \fBstunnel\fR.
O ile nie uXyta zostaXa opcja \fIRNDoverwrite\fR jest to robione
automatycznie.  Do re\*^cznego uzyskania takiego pliku uXyteczna
moXe by\*(ae komenda \fIopenssl rand\fR dostarczana ze wspo\*'Xczesnymi
wersjami pakietu \fIOpenSSL\fR.
.PP
Jeszcze jedna istotna informacja \*(-- jeXeli doste\*^pne jest urzXdzenie
\&\fI/dev/urandom\fR biblioteka \fIOpenSSL\fR ma zwyczaj zasilania nim \s-1PRNG\s0 w trakcie
sprawdzania stanu generatora.  W systemach z \fI/dev/urandom\fR urzXdzenie
to be\*^dzie najprawdopodobniej uXyte, pomimo Xe znajduje sie\*^ na samym kon\*~cu
powyXszej listy.  Jest to wXaXciwoX\*(ae biblioteki \fIOpenSSL\fR, a nie programu
\&\fIstunnel\fR.
.SH "ZOBACZ RO\*'WNIEX"
.IX Header "ZOBACZ RO'WNIEX"
.IP "\fItcpd\fR\|(8)" 4
.IX Item "tcpd"
biblioteka kontroli doste\*^pu do usXug internetowych
.IP "\fIinetd\fR\|(8)" 4
.IX Item "inetd"
\&'super\-serwer' internetowy
.IP "\fIhttp://stunnel.mirt.net/\fR" 4
.IX Item "http://stunnel.mirt.net/"
strona domowa programu \fIstunnel\fR
.IP "\fIhttp://www.stunnel.org/\fR" 4
.IX Item "http://www.stunnel.org/"
najcze\*^Xciej zadawane pytania na temat programu \fIstunnel\fR
.IP "\fIhttp://www.openssl.org/\fR" 4
.IX Item "http://www.openssl.org/"
strona projektu \fIOpenSSL\fR
.SH "AUTOR"
.IX Header "AUTOR"
.IP "MichaX Trojnara" 4
.IX Item "MichaX Trojnara"
<\fIMichal.Trojnara@mirt.net\fR>
